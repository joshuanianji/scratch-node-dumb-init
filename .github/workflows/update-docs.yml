name: Update Docs

on:
  workflow_dispatch:
  pull_request:
    paths:
      - '.github/workflows/update-docs.yml' # this file
      - 'scripts/*'

env:
  TEST_TAG: ${{ github.repository }}
  REGISTRY: ghcr.io

jobs:
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Run Script
        uses: actions/github-script@v6
        id: script
        with:
          result-encoding: string
          script: |
            const script = require('./scripts/update-versions.js')
            await script({ github, context, core })

      - name: Commit and make PR
        uses: peter-evans/create-pull-request@v5
        with:
          author: GitHub <noreply@github.com>
          commit-message: Update Docs
          title: Update Metadata
          body: Update metadata, created by ${{ github.sha }}
          base: ${{ github.base_ref }}
